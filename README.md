# ADISE21_gandalfthegrey
Table of Contents
=================
   * [Εγκατάσταση](#εγκατάσταση)
      * [Απαιτήσεις](#απαιτήσεις)
      * [Οδηγίες Εγκατάστασης](#οδηγίες-εγκατάστασης)
   * [Περιγραφή API](#περιγραφή-api)
      * [Methods](#methods)
         * [deck](#deck)
            * [Ανάγνωση deck](#ανάγνωση-deck)
            * [Αρχικοποίηση deck](#αρχικοποίηση-deck)
            * [Reset βάσης](#reset-βάσης)
         * [card](#card)
            * [Ανάγνωση κάρτας](#ανάγνωση-κάρτας)
            * [ Επιλογή Κάρτας](#επιλογή-κάρτας)
         * [Player](#player)
            * [Ανάγνωση στοιχείων παίκτη](#ανάγνωση-στοιχείων-παίκτη)
            * [Καθορισμός στοιχείων παίκτη](#καθορισμός-στοιχείων-παίκτη)
         * [Status](#status)
            * [Ανάγνωση κατάστασης παιχνιδιού](#ανάγνωση-κατάστασης-παιχνιδιού)
      * [Entities](#entities)
         * [deck](#deck-1)
         * [Players](#players)
         * [Game_status](#game_status)


# Demo Page

Μπορείτε να κατεβάσετε τοπικά ή να επισκευτείτε την σελίδα: https://users.it.teithe.gr/~it164773/adise21/GandalfTheGrey/www/index.html




# Εγκατάσταση

## Απαιτήσεις

* Apache2
* Mysql Server
* php
## Οδηγίες Εγκατάστασης

 * Κάντε clone το project σε κάποιον φάκελο <br/>
  `$ git clone https://github.com/iee-ihu-gr-course1941/ADISE21_gandalfthegrey.git`

 * Βεβαιωθείτε ότι ο φάκελος είναι προσβάσιμος από τον Apache Server. πιθανόν να χρειαστεί να καθορίσετε τις παρακάτω ρυθμίσεις.

 * Θα πρέπει να δημιουργήσετε στην Mysql την βάση με όνομα 'game' και να φορτώσετε σε αυτήν την βάση τα δεδομένα από το αρχείο schema.sql(Το dump δεν λειτουργεί με copy paste σε mysql client λόγο περιέργων auto generated dump data αλλά άμα αντιγράφουν μόνο τα κομμάτια του κώδικα(δημιουργία πινάκων ,inserts,triggers,procedures)δουλεύει κανονικά.)

 * Θα πρέπει να φτιάξετε το αρχείο lib/db_upass.php το οποίο να περιέχει:
```
    <?php
	$DB_PASS = 'κωδικός';
	$DB_USER = 'όνομα χρήστη';
    ?>
```


# Περιγραφή Παιχνιδιού

O μουτζούρης παίζεται ως εξής: Αφού ανακατέψουμε καλά, μοιράζουμε όλη την τράπουλα στους παίχτες έτσι ώστε όλοι να έχουν των ίδιο αριθμό φύλλων (ή + - 1). Κάθε παίχτης αφαιρεί από τα φύλλα που έχει στα χέρια του τα ζευγάρια, δηλαδή, 2 Άσσους 2 δυάρια 2 τριάρια κ.τ.λ. Τα υπόλοιπα τα κρατάμε στο χέρι σαν βεντάλια έτσι ώστε να μπορεί ο άλλος παίχτης να διαλέξει, χωρίς να τα βλέπει, ένα από αυτά. Ο πρώτος παίχτης τραβάει ένα φύλλο από τον αντίπαλο, αν κάνει ζευγάρι το νέο χαρτί με κάποια από τα δικά του τότε τα ρίχνει, αλλιώς τα κρατάει και συνεχίζει ο επόμενος. Όποιος ζευγαρώσει όλα τα φύλλα του βγαίνει από το παιχνίδι. Όποιος μείνει τελευταίος με τον Ρήγα Μπαστούνι (τον Μουτζούρη) στο χέρι του είναι ο χαμένος.

Η βάση μας κρατάει τους εξής πίνακες και στοιχεία : Αρχικά όλο το functionality της εφαρμογής γίνετε αυτόματα στην βάση μέσω stored procedures (π.χ. ανακάτεμα, επιλογή κάρτας, διαγραφή των διπλών κτλ),οι πινάκες είναι οι: deck,game_status,player όπου αποθηκεύονται  τα στοιχειά της τράπουλας και σε ποιον ανήκει το κάθε φύλλο,οι παίκτες το όνομα το token, το τρέχον status του παιχνιδιού ,ποιος έχει σειρά, το αποτέλεσμα εάν έχει βγει καθώς και πότε έγινε η τελευταία αλλαγή.

Η εφαρμογή απαπτύχθηκε μέχρι το σημείο: Player vs player Μουτζουρης(οι χρήστες επικοινωνούν με την βαση μέσω token που παίρνουν αφού δώσουν ένα username)με GUI και sound effects , ενα scoreboard το oποίο δουλέυει στον client και δεν επικοινωνεί με την βαση. Υπήρχε η ιδέα για δυνατότητα παραπάνω από δυο παικτών αλλά δεν πρόλαβε/μπόρεσε να υλοποιηθεί , δεν υπάρχει δυνατότητα ύπαρξης πολλών σύγχρονων παιχνιδιών 

## Συντελεστές
Στο project Πραγματοποιήθηκε ολόκληρο από έμενα(Χαλκίδης Λάζαρος 164773)
με 

GUI Javascript/css/html

Php API

MySQL

# Περιγραφή API

## Methods


### deck
#### Ανάγνωση deck

```
GET /deck/
```

Επιστρέφει το [deck](#Deck-1).

#### Αρχικοποίηση deck
```
POST /deck/
```

Αρχικοποιεί το deck, δηλαδή το παιχνίδι. Γίνονται το ανακάτεμα της τράπουλας, ο διαμοιρασμός και πετιούνται τα πρώτα διπλά φύλλα συμφώνα με τους κανόνες.
Επιστρέφει το [deck](#Deck-1).


#### Reset βάσης
```
PUT /deck/
```


Σβήνει ολα τα στοιχεία της βάσης και δημιουργείται νέο deck.



### card
#### Ανάγνωση κάρτας

```
GET /board/card/:cardid/
```

Κάνει την κίνηση κάρτας από τον έναν owner στον άλλον. Προφανώς ελέγχεται αν είναι η σειρά του παίκτη να παίξει με βάση το token.
Επιστρέφει τα στοιχεία από το [deck](#Deck-1) περιλαμβάνει τις αλλαγές.

#### Επιλογή Κάρτας

```
PUT /deck/card/:cardid/
```
Json Data:

| Field             | Description                 | Required   |
| ----------------- | --------------------------- | ---------- |
| `id`               |  Η  Ταυτότητα κάρτας             | yes        |
| `ow`               | Ο παίκτης στον όποιο θα μετακινηθεί η κάρτα επειδή την επέλεξε             | yes        |

Επιστρέφει τα στοιχεία από το [deck](#Deck=1) περιλαμβάνει τις αλλαγές


### Player

#### Ανάγνωση στοιχείων παίκτη
```
GET /players/:p
```

Επιστρέφει τα στοιχεία του παίκτη p ή όλων των παικτών αν παραληφθεί. Το p μπορεί να είναι 'p1' ή 'p2'.

#### Καθορισμός στοιχείων παίκτη
```
PUT /players/:p
```
Json Data:

| Field             | Description                 | Required   |
| ----------------- | --------------------------- | ---------- |
| `username`        | Το username για τον παίκτη p. | yes        |
| `p_turn`           |  ο παίκτης p. | yes        |


Επιστρέφει τα στοιχεία του παίκτη p και ένα token. Το token πρέπει να το χρησιμοποιεί ο παίκτης καθόλη τη διάρκεια του παιχνιδιού.

### Status

#### Ανάγνωση κατάστασης παιχνιδιού
```
GET /status/
```

Επιστρέφει το στοιχείο [Game_status](#Game_status).



## Entities


### Deck
---------

Το deck είναι ένας πίνακας, ο οποίος στο κάθε στοιχείο έχει τα παρακάτω:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `cardid`                      | Η   Ταυτότητα κάρτας          | 1..41                                |
| `suits`                      | Tο χρώμα/σχήμα της κάρτας            | "♥","♦","♠","♣"                            |
| `val`                |Η αξία της κάρτας                      |"A",2,3,4,5,6,7,8,9,10,"J","Q","K"                      |
| `owning`            | Ο κάτοχος της κάρτας                       | 'player1','player2','player3','player4','player5','player6' null                       |



### Players
---------

O κάθε παίκτης έχει τα παρακάτω στοιχεία:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `username`               | Όνομα παίκτη                                 | String                              |
| `p_turn`            | ο παίκτης                | 'p1','p2','p3','p4','p5','p6'                             |
| `token  `                | To κρυφό token του παίκτη. Επιστρέφεται μόνο τη στιγμή της εισόδου του παίκτη στο παιχνίδι | HEX |


### Game_status
---------

H κατάσταση παιχνιδιού έχει τα παρακάτω στοιχεία:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `status  `               | Κατάσταση             | 'not active', 'initialized', 'started', 'ended', 'aborded'     |
| `p_turn`                 | O παίκτης που παίζει        | 'p1','p2','p3','p4','p5','p6' ,null                              |
| `result`                 |  O παίκτης που κέρδισε |'p1','p2','p3','p4','p5','p6','D',null                              |
| `last_change`            | Τελευταία αλλαγή/ενέργεια στην κατάσταση του παιχνιδιού         | timestamp |
